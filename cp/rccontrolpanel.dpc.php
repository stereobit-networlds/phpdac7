<?php
$__DPCSEC['RCCONTROLPANEL_DPC']='1;1;1;1;1;1;1;1;1;1;1';

if (!defined("RCCONTROLPANEL_DPC")) { 
define("RCCONTROLPANEL_DPC",true);

$__DPC['RCCONTROLPANEL_DPC'] = 'rccontrolpanel';
 
$__EVENTS['RCCONTROLPANEL_DPC'][0]='cp';
$__EVENTS['RCCONTROLPANEL_DPC'][1]='cplogout';
$__EVENTS['RCCONTROLPANEL_DPC'][2]='cplogin';
$__EVENTS['RCCONTROLPANEL_DPC'][3]='cpinfo';
$__EVENTS['RCCONTROLPANEL_DPC'][4]='cpchartshow';
$__EVENTS['RCCONTROLPANEL_DPC'][5]='cpzbackup';
$__EVENTS['RCCONTROLPANEL_DPC'][6]='cpupgrade';

$__ACTIONS['RCCONTROLPANEL_DPC'][0]='cp';
$__ACTIONS['RCCONTROLPANEL_DPC'][1]='cplogout';
$__ACTIONS['RCCONTROLPANEL_DPC'][2]='cplogin';
$__ACTIONS['RCCONTROLPANEL_DPC'][3]='cpinfo';
$__ACTIONS['RCCONTROLPANEL_DPC'][4]='cpchartshow';
$__ACTIONS['RCCONTROLPANEL_DPC'][5]='cpzbackup';
$__ACTIONS['RCCONTROLPANEL_DPC'][6]='cpupgrade';

$__LOCALE['RCCONTROLPANEL_DPC'][0]='RCCONTROLPANEL_DPC;Control Panel;Control Panel';
$__LOCALE['RCCONTROLPANEL_DPC'][1]='_BACKCP;Back;Επιστροφή';
$__LOCALE['RCCONTROLPANEL_DPC'][2]='_DASHBOARD;Dashboard;Πινακας Ελεγχου';
$__LOCALE['RCCONTROLPANEL_DPC'][3]='_MENU;General info;Βασικές πληροφορίες';
$__LOCALE['RCCONTROLPANEL_DPC'][4]='_statisticscat;Category Viewed/Month;Επισκεψιμότητα κατηγοριών';
$__LOCALE['RCCONTROLPANEL_DPC'][5]='_statistics;Items Viewed/Month;Επισκεψιμότητα ειδών';
$__LOCALE['RCCONTROLPANEL_DPC'][6]='_transactions;Transaction/Month;Συναλλαγές ανα μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][7]='_applications;Applications Birth/Month;Νεές εφαρμογές ανα μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][8]='_appexpires;Applications Expires/Month;Ληξεις εφαρμογών ανα μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][9]='_mailqueue;Mail send/Month;Σταλθέντα e-mail ανα μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][10]='_mailsendok;Mail Received/Month;Παρεληφθέντα e-mail ανα μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][11]='_income;Income;Εισόδημα';
$__LOCALE['RCCONTROLPANEL_DPC'][12]='_moretrans;All transactions;Όλες οι συναλλαγές';

//cpmdbrec commands
$__LOCALE['RCCONTROLPANEL_DPC'][13]='_awstats;Web statistics;Στατιστικά';
$__LOCALE['RCCONTROLPANEL_DPC'][14]='_google_analytics;Google Analytics;Στατιστικά Google';
$__LOCALE['RCCONTROLPANEL_DPC'][15]='_siwapp;Siwapp;Siwapp τιμολόγηση';
$__LOCALE['RCCONTROLPANEL_DPC'][16]='_revenue;Revenue;Αξία';
$__LOCALE['RCCONTROLPANEL_DPC'][17]='_inactives;Inactives;Μη ενεργά';
$__LOCALE['RCCONTROLPANEL_DPC'][18]='_actives;Actives;Ενεργά';
$__LOCALE['RCCONTROLPANEL_DPC'][19]='_resources;Resources;Κατανάλωση χώρου';
$__LOCALE['RCCONTROLPANEL_DPC'][20]='_total;Total;Σύνολο';
$__LOCALE['RCCONTROLPANEL_DPC'][21]='_alerts;Alerts;Ειδοποιήσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][22]='_MENU7;Orders;Κινήσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][23]='_add_categories;Upload Categories;Εισαγωγή κατηγοριών';
$__LOCALE['RCCONTROLPANEL_DPC'][24]='_add_products;Upload Products;Εισαγωγή ειδών';

$__LOCALE['RCCONTROLPANEL_DPC'][25]='_google_addwords;Google Adwords;Google Adwords';
$__LOCALE['RCCONTROLPANEL_DPC'][26]='_upload_logo;Upload logo;Αλλαγή λογοτύπου';
$__LOCALE['RCCONTROLPANEL_DPC'][27]='_add_recaptcha;ReCaptcha;ReCaptcha';
$__LOCALE['RCCONTROLPANEL_DPC'][28]='_update;Update;Αναβάθμιση';
$__LOCALE['RCCONTROLPANEL_DPC'][29]='_backup;Backup;Αποθήκευση';
$__LOCALE['RCCONTROLPANEL_DPC'][30]='_backup_content;Backup contents;Αποθήκευση στοιχείων';
$__LOCALE['RCCONTROLPANEL_DPC'][31]='_maildbqueue;Newsletters & mailing lists;Μαζικές αποστολές e-mails';
$__LOCALE['RCCONTROLPANEL_DPC'][32]='_sendnewsletters;Enable newsletter mailing list feature;Ενεργοποίηση μαζικών αποστολών e-mails';
$__LOCALE['RCCONTROLPANEL_DPC'][33]='_TWEETSRSS;Feeds & tweets;Ενημέρωση';
$__LOCALE['RCCONTROLPANEL_DPC'][34]='_add_domainname;Domain name;Domain name';
$__LOCALE['RCCONTROLPANEL_DPC'][35]='_customers;Customers;Πελάτες';
$__LOCALE['RCCONTROLPANEL_DPC'][36]='_installeshop;Install e-shop;Εγκατάσταση e-shop';
$__LOCALE['RCCONTROLPANEL_DPC'][37]='_uninstalleshop;Uninstall e-shop;Κατάργηση e-shop';
$__LOCALE['RCCONTROLPANEL_DPC'][38]='_eshop;e-shop module;e-shop πρόσθετο';
$__LOCALE['RCCONTROLPANEL_DPC'][39]='_install;Install;Εγκατάσταση';
$__LOCALE['RCCONTROLPANEL_DPC'][40]='_ckfinder;CKfinder;CKfinder';
$__LOCALE['RCCONTROLPANEL_DPC'][41]='_jqgrid;JQgrid;JQgrid';
$__LOCALE['RCCONTROLPANEL_DPC'][42]='_ieditor;IEditor;IEditor';
$__LOCALE['RCCONTROLPANEL_DPC'][43]='_addons;Addons;Πρόσθετα';
$__LOCALE['RCCONTROLPANEL_DPC'][44]='_edit_htmlfiles;Edit system files;Επεξεργασία αρχείων συστήματος';
$__LOCALE['RCCONTROLPANEL_DPC'][45]='_addspace;Limited space, add space;Πρόσθεσε χωρητικότητα';
$__LOCALE['RCCONTROLPANEL_DPC'][46]='_ago;after expiration;που έληξε';
$__LOCALE['RCCONTROLPANEL_DPC'][47]='_fromnow;before expire;πρίν τη λήξη';
$__LOCALE['RCCONTROLPANEL_DPC'][48]='_modified;modified;Ενημερώθηκε';
$__LOCALE['RCCONTROLPANEL_DPC'][49]='_ago2;ago;πρίν';
$__LOCALE['RCCONTROLPANEL_DPC'][50]='_fromnow2;from now;μετά';
$__LOCALE['RCCONTROLPANEL_DPC'][51]='_cpimages;Update icons;Ενημέρωση εικονιδίων';
$__LOCALE['RCCONTROLPANEL_DPC'][52]='_addkey;Add key;Εισαγωγή κλειδιού';
$__LOCALE['RCCONTROLPANEL_DPC'][53]='_genkey;Gen key;Δημιουργία κλειδιού';
$__LOCALE['RCCONTROLPANEL_DPC'][54]='_validatekey;Validate key;Έλεγχος κλειδιού';
$__LOCALE['RCCONTROLPANEL_DPC'][55]='_desendnewsletters;Uninstall newsletter feature;Απεγκατάσταση μαζικών αποστολών e-mails';
$__LOCALE['RCCONTROLPANEL_DPC'][56]='_newsletters;Newsletter feature installed;Αποστολή e-mails εγκατεστημένο';
$__LOCALE['RCCONTROLPANEL_DPC'][57]='_year;Year;Έτος';
$__LOCALE['RCCONTROLPANEL_DPC'][58]='_month;Month;Μήνας';
$__LOCALE['RCCONTROLPANEL_DPC'][59]='_more;More...;Περισσότερα...';

$__LOCALE['RCCONTROLPANEL_DPC'][60]='_exit;Exit;Έξοδος';
$__LOCALE['RCCONTROLPANEL_DPC'][61]='_dashboard;Dashboard;Πίνακας ελέγχου';
$__LOCALE['RCCONTROLPANEL_DPC'][62]='_logout;Logout;Αποσύνδεση';
$__LOCALE['RCCONTROLPANEL_DPC'][63]='_rssfeeds;RSS Feeds;RSS Feeds';
$__LOCALE['RCCONTROLPANEL_DPC'][64]='_edititemtext;Edit Item Text;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][65]='_deleteitemattachment;Delete Item Attachment;Διαγραφή συνημμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][66]='_editcat;Edit Category;Μεταβολή κατηγορίας';
$__LOCALE['RCCONTROLPANEL_DPC'][67]='_addcat;Add Category;Νέα Κατηγορία';
$__LOCALE['RCCONTROLPANEL_DPC'][68]='_additem;Add Item;Νέο Είδος';
$__LOCALE['RCCONTROLPANEL_DPC'][69]='_webstatistics;Statistics;Στατιστικά';
$__LOCALE['RCCONTROLPANEL_DPC'][70]='_addcathtml;Add Category Html;Προσθήκη κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][71]='_editcathtml;Edit Category Html;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][72]='_edititem;Edit Item;Μεταβολή είδους';
$__LOCALE['RCCONTROLPANEL_DPC'][73]='_edititemphoto;Edit Photo;Μεταβολή φωτογραφίας';
$__LOCALE['RCCONTROLPANEL_DPC'][74]='_edititemdbhtm;Edit Item Htm;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][75]='_edititemdbhtml;Edit Item Html;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][76]='_edititemdbtext;Edit Item Text;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][77]='_senditemmail;Send e-mail;Αποστολή e-mail';
$__LOCALE['RCCONTROLPANEL_DPC'][78]='_delitemattachment;Delete Text;Διαγραφή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][79]='_edititemtext;Edit Item Text;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][80]='_edititemhtm;Edit Item Htm;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][81]='_edititemhtml;Edit Item Html;Μεταβολή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][82]='_additemhtml;Add Item Html;Εισαγωγή κειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][83]='_transactions;Transactions;Συναλλαγές';
$__LOCALE['RCCONTROLPANEL_DPC'][84]='_users;Users;Χρήστες';
$__LOCALE['RCCONTROLPANEL_DPC'][85]='_itemattachments2db;Add Items to DB;Μεταφορά κειμένων στην Β.Δ.';
$__LOCALE['RCCONTROLPANEL_DPC'][86]='_importdb;Import;Εισαγωγή';
$__LOCALE['RCCONTROLPANEL_DPC'][87]='_config;Configuration;Ρυθμίσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][88]='_contactform;Contact Form;Φόρμα επικοινωνίας';
$__LOCALE['RCCONTROLPANEL_DPC'][89]='_subscribers;Subscribers;Συνδρομητές';
$__LOCALE['RCCONTROLPANEL_DPC'][90]='_sitemap;Sitemap;Χάρτης πλοήγησης';// αντικειμένων';
$__LOCALE['RCCONTROLPANEL_DPC'][91]='_search;Search;Φόρμα Αναζήτησης';
$__LOCALE['RCCONTROLPANEL_DPC'][92]='_upload;Upload files;Ανέβασμα αρχείων';
$__LOCALE['RCCONTROLPANEL_DPC'][93]='_uploadid;Upload item files;Ανέβασμα αρχείων';// αντικειμένου';
$__LOCALE['RCCONTROLPANEL_DPC'][94]='_uploadcat;Upload category files;Ανέβασμα αρχείων';// κατηγορίας';
$__LOCALE['RCCONTROLPANEL_DPC'][95]='_syncphoto;Sync photos;Συγχρονισμός φωτογραφιών';
$__LOCALE['RCCONTROLPANEL_DPC'][96]='_syncsql;Sync data;Συγχρονισμός δεδομένων';
$__LOCALE['RCCONTROLPANEL_DPC'][97]='_dbphoto;Image in DB;Εικόνα στην βάση δεδομένων';
$__LOCALE['RCCONTROLPANEL_DPC'][98]='_editctag;Category Tags;Tags κατηγορίας';
$__LOCALE['RCCONTROLPANEL_DPC'][99]='_edititag;Item Tags;Tags είδους';
$__LOCALE['RCCONTROLPANEL_DPC'][100]='_menu;Menu;Μενού';
$__LOCALE['RCCONTROLPANEL_DPC'][101]='_slideshow;Slideshow;Slideshow';
$__LOCALE['RCCONTROLPANEL_DPC'][102]='_ckfinder;Upload files;Upload αρχείων';
$__LOCALE['RCCONTROLPANEL_DPC'][103]='_webmail;Web Mail;Web Mail';
$__LOCALE['RCCONTROLPANEL_DPC'][104]='_editpage;Edit Page;Επεξεργασία σελίδας';
$__LOCALE['RCCONTROLPANEL_DPC'][105]='_rempass;Forgotten password;Ανάκτηση κωδικού';
$__LOCALE['RCCONTROLPANEL_DPC'][106]='_chpass;Change password;Αλλαγή κωδικού';
$__LOCALE['RCCONTROLPANEL_DPC'][107]='_cphelp;Ηelp;Βοήθεια';
$__LOCALE['RCCONTROLPANEL_DPC'][108]='_cpupgrade;Upgrade;Αναβάθμιση';
$__LOCALE['RCCONTROLPANEL_DPC'][109]='_cpwizard;Enable wizard;Οδηγός εγκατάστασης';
$__LOCALE['RCCONTROLPANEL_DPC'][110]='_cpdhtmlon;Windows mode;Πλοήγηση Windows';
$__LOCALE['RCCONTROLPANEL_DPC'][111]='_cpdhtmloff;Frames mode;Πλοήγηση Frames';
$__LOCALE['RCCONTROLPANEL_DPC'][112]='_cpcropwiz;Crop wizard;Crop wizard';
$__LOCALE['RCCONTROLPANEL_DPC'][113]='_OPTIONS;Options;Επιλογές';
$__LOCALE['RCCONTROLPANEL_DPC'][114]='_ADD;Add;Προσθήκη';
$__LOCALE['RCCONTROLPANEL_DPC'][115]='_CATEGORY;Category;Κατηγορία';
$__LOCALE['RCCONTROLPANEL_DPC'][116]='_ITEM;Item;Είδος';
$__LOCALE['RCCONTROLPANEL_DPC'][117]='_SETTINGS;Settings;Ρυθμίσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][118]='_customers;Customers;Πελάτες';
$__LOCALE['RCCONTROLPANEL_DPC'][119]='_EDITHTML;Edit Html;Σελίδες Html';
$__LOCALE['RCCONTROLPANEL_DPC'][120]='_SELECTHTML;Select Html;Επιλογή Html';
$__LOCALE['RCCONTROLPANEL_DPC'][121]='_ADDFAST;Add item;Εισαγωγή είδους';
$__LOCALE['RCCONTROLPANEL_DPC'][122]='_addtag;Add Tag;Εισαγωγή Ετικέτας';
$__LOCALE['RCCONTROLPANEL_DPC'][123]='_back;Back;Επιστροφή';
$__LOCALE['RCCONTROLPANEL_DPC'][124]='_mailqueue;Mail queue;Μαζικές Αποστολές';
$__LOCALE['RCCONTROLPANEL_DPC'][125]='_ENTITIES;Entities;Στοιχεία';
$__LOCALE['RCCONTROLPANEL_DPC'][126]='_categories;Sections;Κατηγορίες';
$__LOCALE['RCCONTROLPANEL_DPC'][127]='_items;Items;Αντικείμενα';
$__LOCALE['RCCONTROLPANEL_DPC'][128]='_configmenu;Config menu;Ρυθμίσεις menu';
$__LOCALE['RCCONTROLPANEL_DPC'][129]='_xmlfeeds;XML feeds;XML feeds';
$__LOCALE['RCCONTROLPANEL_DPC'][130]='_dynsql;SQL Syncs;Συγχρονισμοί';
$__LOCALE['RCCONTROLPANEL_DPC'][131]='_bmailqueue;Responds;Απαντήσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][132]='_bmailqueueadd;Subscribers;Λίστες';
$__LOCALE['RCCONTROLPANEL_DPC'][133]='_bmailsend;Send;Αποστολή';
$__LOCALE['RCCONTROLPANEL_DPC'][134]='_bmail;e-Mail;e-Mail';
$__LOCALE['RCCONTROLPANEL_DPC'][135]='_bmailstats;Statistics;Στατιστική';
$__LOCALE['RCCONTROLPANEL_DPC'][136]='_bmailcamp;Campaigns;Καμπάνιες';
$__LOCALE['RCCONTROLPANEL_DPC'][137]='_ITEMCOLLECTION;Select items;Επιλογή ειδών';
$__LOCALE['RCCONTROLPANEL_DPC'][138]='_GNAVAL;Empty;Μη διαθέσιμο';
$__LOCALE['RCCONTROLPANEL_DPC'][139]='_caddress;Addresses;Διευθύνσεις';
$__LOCALE['RCCONTROLPANEL_DPC'][140]='_susers;Superusers;Διαχειριστές';
$__LOCALE['RCCONTROLPANEL_DPC'][141]='_mins;minutes;λεπτά';
$__LOCALE['RCCONTROLPANEL_DPC'][142]='_hrs;hours;ώρες';
$__LOCALE['RCCONTROLPANEL_DPC'][143]='_days;days;ημέρες';
$__LOCALE['RCCONTROLPANEL_DPC'][144]='_ago;ago;πριν';
$__LOCALE['RCCONTROLPANEL_DPC'][145]='_error;Error;Λάθος';
$__LOCALE['RCCONTROLPANEL_DPC'][146]='_warning;Warning;Προειδοποίηση';
$__LOCALE['RCCONTROLPANEL_DPC'][147]='_important;Important;Σημαντικό';
$__LOCALE['RCCONTROLPANEL_DPC'][148]='_info;Info;Πληροφορία';
$__LOCALE['RCCONTROLPANEL_DPC'][149]='_success;Success;Επιτυχία';
$__LOCALE['RCCONTROLPANEL_DPC'][150]='_message;Message;Μήνυμα';
$__LOCALE['RCCONTROLPANEL_DPC'][151]='_messages;Messages;Μηνύματα';
$__LOCALE['RCCONTROLPANEL_DPC'][152]='_viewallmessages;All messages;Όλα τα μηνύματα';
$__LOCALE['RCCONTROLPANEL_DPC'][153]='_sec;Sec;δευτερόλεπτα';
$__LOCALE['RCCONTROLPANEL_DPC'][154]='_date;Date;Ημερομηνία';
$__LOCALE['RCCONTROLPANEL_DPC'][155]='_type;Type;Τύπος';
$__LOCALE['RCCONTROLPANEL_DPC'][156]='_sale;Invoice created;Παραστατικό πώλησης';
$__LOCALE['RCCONTROLPANEL_DPC'][157]='_installprinter;Install printer;Εγκατάσταση printer';
$__LOCALE['RCCONTROLPANEL_DPC'][158]='_system;System;System';
$__LOCALE['RCCONTROLPANEL_DPC'][159]='_sysmessages;Messages;Μηνύματα';
$__LOCALE['RCCONTROLPANEL_DPC'][160]='_visits;Visits;Επισκέπτες';
$__LOCALE['RCCONTROLPANEL_DPC'][161]='_attr1;Category;Κατηγορία';
$__LOCALE['RCCONTROLPANEL_DPC'][162]='_attr2;Visitor;Επισκέπτης';
$__LOCALE['RCCONTROLPANEL_DPC'][163]='_attr3;Visitor;Επισκέπτης';
$__LOCALE['RCCONTROLPANEL_DPC'][164]='_ip;Ip;Ip';
$__LOCALE['RCCONTROLPANEL_DPC'][165]='_tid;Item;Είδος';
$__LOCALE['RCCONTROLPANEL_DPC'][166]='minute;minute;λεπτό';
$__LOCALE['RCCONTROLPANEL_DPC'][167]='minutes;minutes;λεπτά';
$__LOCALE['RCCONTROLPANEL_DPC'][168]='hour;hour;ώρα';
$__LOCALE['RCCONTROLPANEL_DPC'][169]='hours;hours;ώρες';
$__LOCALE['RCCONTROLPANEL_DPC'][170]='day;day;ημέρα';
$__LOCALE['RCCONTROLPANEL_DPC'][171]='days;days;ημέρες';
$__LOCALE['RCCONTROLPANEL_DPC'][172]='month;month;μήνα';
$__LOCALE['RCCONTROLPANEL_DPC'][173]='months;months;μήνες';
$__LOCALE['RCCONTROLPANEL_DPC'][174]='year;year;έτος';
$__LOCALE['RCCONTROLPANEL_DPC'][175]='years;years;έτη';
$__LOCALE['RCCONTROLPANEL_DPC'][176]='second;second;δεύτερόλεπτο';
$__LOCALE['RCCONTROLPANEL_DPC'][177]='seconds;seconds;δευτερόλεπτα';
$__LOCALE['RCCONTROLPANEL_DPC'][178]='_inactiveuser;Inactive user;Μη ενεργός χρήστης';
$__LOCALE['RCCONTROLPANEL_DPC'][179]='_newactiveuser;New user;Νέος χρήστης';
$__LOCALE['RCCONTROLPANEL_DPC'][180]='_formsubmit;Message;Μηνυμα';
$__LOCALE['RCCONTROLPANEL_DPC'][181]='_unsubinbox;Unsubscribed;Διαγραφή απο λίστα email ';
$__LOCALE['RCCONTROLPANEL_DPC'][182]='_subinbox;Subscribed;Εγγραφή σε λίστα email';
$__LOCALE['RCCONTROLPANEL_DPC'][183]='_login;Login;Σύνδεση';
$__LOCALE['RCCONTROLPANEL_DPC'][184]='_fblogin;Login (fb);Σύνδεση (fb)';
$__LOCALE['RCCONTROLPANEL_DPC'][185]='_reginbox;Registration;Εγγραφή';
$__LOCALE['RCCONTROLPANEL_DPC'][186]='_actinbox;Activation;Ενεργοποίηση';
$__LOCALE['RCCONTROLPANEL_DPC'][187]='_logfail;Login failed;Αποτυχημένη είσοδος';
$__LOCALE['RCCONTROLPANEL_DPC'][188]='_upgradeplan;Please upgrade your hosting plan;Παρακαλώ αυξήστε τον χώρο φιλοξενίας';
$__LOCALE['RCCONTROLPANEL_DPC'][189]='_sizeconsumed;Size near to limit;Κατανάλωση χωρητικότητας';
$__LOCALE['RCCONTROLPANEL_DPC'][190]='_views;Views;Προβολές';

class rccontrolpanel {

	var $title, $subpath, $path, $prpath;
	var $charset, $application_path, $url, $urlpath;
	var $appkey, $awstats_url;
	var $stats, $cpStats, $hasgraph, $gotourl;
	var $turl, $cpGet, $turldecoded, $tasks;
	var $owner, $seclevid, $userDemoIds, $crmLevel, $isCrm;
	var $rootapp_path;
		
	public function __construct() {
		
		$murl = arrayload('SHELL','ip');
        $this->url = $murl[0]; 			
		$this->charset = 'utf-8';			
		
        $this->urlpath = paramload('SHELL','urlpath');		
		$this->subpath = $this->urlpath . "/cp";		
		$this->path = paramload('SHELL','urlpath') . $this->subpath;   		
		$this->prpath = paramload('SHELL','prpath');	
        $this->application_path = paramload('SHELL','urlpath');			
		$this->rootapp_path = remote_paramload('RCCONTROLPANEL','rootpath',$this->prpath); 
	    $this->title = localize('RCCONTROLPANEL_DPC',getlocal());		
		
		$this->owner = $_POST['Username'] ? $_POST['Username'] : GetSessionParam('LoginName');
		$this->seclevid = $GLOBALS['ADMINSecID'] ? $GLOBALS['ADMINSecID'] : $_SESSION['ADMINSecID'];		
		
		$this->gotourl = seturl('t=cp&group=' . GetReq('group'));		
		$this->userDemoIds = array(6,7); 
		
		$crmSecurityLevel = paramload('CRM','seclevel'); 
		$this->crmLevel = $crmSecurityLevel ? $crmSecurityLevel : 9;
		
		$this->stats = array();
		$this->cpStats = false;
		$this->isCrm = false;	

		$this->tasks = GetSessionParam('cpTasks') ? GetSessionParam('cpTasks') : array();
		$this->inbox = GetSessionParam('cpInbox') ? GetSessionParam('cpInbox') : array();			
				
		$this->load_javascript();	
	}
	 	
    public function event($sAction) {    	  
	
		$login = $GLOBALS['LOGIN'] ? $GLOBALS['LOGIN'] : $_SESSION['LOGIN'];
		if ($login!='yes') return null;	
	   
		$this->autoupdate();	  //!!!!! 
  
		switch ($sAction) {
	   
	     case 'cpzbackup' 	: 	break;
							 
		 case 'cpchartshow'	: 	if ($report = GetReq('report')) {//ajax call
									$this->hasgraph = _m("swfcharts.create_chart_data use $report");
									$this->gotourl = seturl('t=cpchartshow&group='.GetReq('group').'&ai=1&report='.$report.'&statsid=');
								}
								break;	   			 
	   	
         case "cplogout"    : 	$this->logout();
								break;

		 case "cplogin"     :	$valid = $this->verify_login();						  
							    break;
		 case "cpinfo"      :	//ajax call
								$this->site_stats();  //run stats
								echo $this->cpinfo($_GET['s']);
								die();
								break;
							 
		 case "cpupgrade"   :					 
		 case "cp"          :
		 default         	:   $this->isCrmEnabled();	
		}  

    }
  
    public function action($sAction) {

	    $login = $GLOBALS['LOGIN'] ? $GLOBALS['LOGIN'] : $_SESSION['LOGIN'];
	    if ($login!='yes') return null;
	   
	    switch ($sAction) {
		    
			case 'cpzbackup'   : 	$out = $this->zip_directory(GetReq('zname'),GetReq('zpath'));
									break;
		  
		    case 'cpchartshow' : 	if ($this->hasgraph)//ajax call
										$out = _m("swfcharts.show_chart use " . GetReq('report') ."+500+240+" . $this->gotourl);								  
									else
										$out = "<h3>".localize('_GNAVAL',0)."</h3>";	
									die(GetReq('report').'|'.$out); //ajax return
									break;
								 		
		  	case "cpinfo"      : 	break;    
			case "cpupgrade"   :
			case "cp"          :	
			default            : 	$this->getTURL();
									$this->site_stats(); 
			  
		} 		 		  

		$this->cpStats = $this->isStats(); 	 
				
	    return ($out);
    } 
	
	public function isDemoUser() {
		return (in_array($this->seclevid, $this->userDemoIds));
	}	
	
	public function isLevelUser($level=6) {
		return ($this->seclevid>=$level ? true : false);
	}	
	
	public function isCrmUser() {
		return ($this->seclevid>=$this->crmLevel ? true : false);
	}

	public function isCrmEnabled() {
		if ((defined('CRMFORMS_DPC')) && ($this->isCrmUser())) {
			$this->isCrm = true;
			return true;
		}	

		return false;		
	}	
	
	protected function getTURL() {
		$postedTURL = $_POST['turl'] ? $_POST['turl'] : $_GET['turl']; 
		
		if ($postedTURL) {//a post from login screen
		    $this->turl = $postedTURL ;
			$this->turldecoded = str_replace('_&_', '_%26_', base64_decode($postedTURL)); 	
			$urlquery = parse_url($this->turldecoded); 
			parse_str($urlquery['query'], $getp); 	
			$this->cpGet = $getp;
		
			SetSessionParam('turl', $postedTURL);		
			SetSessionParam('turldecoded', $this->turldecoded);
			SetSessionParam('cpGet', base64_encode(serialize($this->cpGet)));
			
			return true;	
	    }
		elseif ($turl = $_SESSION['turl']) {//GetSessionParam('turl')) {
			$this->turl = $turl;
			$this->turldecoded = GetSessionParam('turldecoded');
			$this->cpGet = unserialize(base64_decode($_SESSION['cpGet']));			
			//echo 'insession:',print_r($_POST); print_r($this->cpGet);
			return true;
		} 
		
		return false;
	}
	
	protected function load_javascript() {
        if (iniload('JAVASCRIPT')) {

			$code = $this->javascript();
		   
			$js = new jscript;	
			$js->load_js($code,null,1);		
			unset ($js);
	    } 
	}

	//called by footer html
	public function javascript() {		
		$cbpage = 'cpmessages.php';
		
		$js = " 		
function inbox()
{
	$.ajax({
	  url: '$cbpage?t=cpinboxno',
	  type: 'GET',
	  success:function(data) {			
			$('#cpinboxno').html(data);
			setTimeout(function() { 
			  $.ajax({
				url: '$cbpage?t=cpinbox',
				type: 'GET',
				success:function(indata) {
					$('#cpinbox').html(indata);
					setTimeout(function() { 
					  $.ajax({
						url: '$cbpage?t=cpmessagesno',
						type: 'GET',
						success:function(mdata) {
							$('#cpmessagesno').html(mdata);
							setTimeout(function() { 
							  $.ajax({
								url: '$cbpage?t=cpmessages',
								type: 'GET',
								success:function(msdata) {
									$('#cpmessages').html(msdata);
									setTimeout(function() { 
									  $.ajax({
										url: '$cbpage?t=cptasksno',
										type: 'GET',
										success:function(tdata) {
											$('#cptasksno').html(tdata);
											setTimeout(function() { 
											  $.ajax({
												url: '$cbpage?t=cptasks',
												type: 'GET',
												success:function(tsdata) {
													$('#cptasks').html(tsdata);
												}
											  });
											}, 50);											
										}
									  });
									}, 40);									
								}
							  });
							}, 30);							
						}
					  });
					}, 20); 					
				}
			  });
			}, 10);  
	  }
	}); 
}

function init(){ 
	inbox(); 
} 

$(document).ready(function(){
	inbox();
	window.setInterval('inbox()',60100);	
});	
";

		return $js;
	}	   	
	
	public function avoidBotsSQL($field=null, $useand=false) {
		$agent = $a ? $a : $this->useragent;
		$avoiduseragent = _m("cms.arrayload use CMS+httpUserAgentsToAvoid");
		
		if (!empty($avoiduseragent))
			$sSQL = " $field NOT REGEXP '" . implode("|", $avoiduseragent) . "'";

		$sSQL.= ($sSQL && $useand) ? " and " : null;			
		
		return ($sSQL);
	}	
	
    public function select_timeline($template=null, $year=null, $month=null) {
		$t = GetReq('t') ? GetReq('t') : 'cp';
		$year = GetParam('year') ? GetParam('year') : date('Y'); 
	    $month = GetParam('month') ? GetParam('month') : date('m');
		$daterange = GetParam('rdate');
			
	    if ($template) {
			
			$tdata = _m("cmsrt.select_template use $template+1");
			
			for ($y=$y=(date('Y')-2); $y<=intval(date('Y')); $y++) {
				$yearsli .= '<li>'. seturl('t='.$t.'&month='.$month.'&year='.$y, $y) .'</li>';
			}
		
			for ($m=1;$m<=12;$m++) {
				$mm = sprintf('%02d',$m);
				$monthsli .= '<li>' . seturl('t='.$t.'&month='.$mm.'&year='.$year, $mm) .'</li>';
			}	  
			
			//call cpGet from rcpmenu not this (only def action)
			$cpGet = _v('rcpmenu.cpGet');	
			$csep = _m('cmsrt.sep');
			if ($id = _m("cmsrt.getRealItemCode use " . $cpGet['id']))
				$section = ' &gt; ' . $this->getItemName($id);
			elseif ($cat = $cpGet['cat'])
				$section = ' &gt; ' . str_replace($csep, ' &gt; ', _m("cmsrt.replace_spchars use $cat+1"));
			else
				$section = null;
	  
	        $posteddaterange = $daterange ? ' &gt; ' . $daterange : ($year ? ' &gt; ' . $month . ' ' . $year : null) ;
	  
			$tokens[] = localize('RCCONTROLPANEL_DPC',getlocal()) . $section . $posteddaterange; 
			$tokens[] = $year;
			$tokens[] = $month;
			$tokens[] = localize('_year',getlocal());
			$tokens[] = $yearsli;
			$tokens[] = localize('_month',getlocal());			
			$tokens[] = $monthsli;	
            $tokens[] = $daterange;			
		
			$ret = $this->combine_tokens($tdata, $tokens); 				
     
			return ($ret);
		}
		
		return null;	
    }	
  
 	public function sqlDateRange($fieldname, $istimestamp=false, $and=false) {
		$sqland = $and ? ' AND' : null;
		if ($daterange = GetParam('rdate')) {//post
			$range = explode('-',$daterange);
			$dstart = str_replace('/','-',trim($range[0]));
			$dend = str_replace('/','-',trim($range[1]));
			if ($istimestamp)
				$dateSQL = $sqland . " DATE($fieldname) BETWEEN STR_TO_DATE('$dstart','%m-%d-%Y') AND STR_TO_DATE('$dend','%m-%d-%Y')";
			else			
				$dateSQL = $sqland . " $fieldname BETWEEN STR_TO_DATE('$dstart','%m-%d-%Y') AND STR_TO_DATE('$dend','%m-%d-%Y')";		
		}				
		elseif ($y = GetReq('year')) {
			if ($m = GetReq('month')) { $mstart = $m; $mend = $m;} else { $mstart = '01'; $mend = '12'; $m = date('m');}
			$daysofmonth = cal_days_in_month(CAL_GREGORIAN, $m, $y);
				
			if ($istimestamp)
				$dateSQL = $sqland . " DATE($fieldname) BETWEEN '$y-$mstart-01' AND '$y-$mend-$daysofmonth'";
			else
				$dateSQL = $sqland . " $fieldname BETWEEN '$y-$mstart-01' AND '$y-$mend-$daysofmonth'";
		}	
        else {
			//always this year by default
			//$mstart = '01'; $mend = '12';
			//always this month by default
			$mstart = date('m'); $mend = date('m');
			$y = date('Y');
			$daysofmonth = date('t');
			
			if ($istimestamp)
				$dateSQL = $sqland . " DATE($fieldname) BETWEEN '$y-$mstart-01' AND '$y-$mend-$daysofmonth'";
			else
				$dateSQL = $sqland . " $fieldname BETWEEN '$y-$mstart-01' AND '$y-$mend-$daysofmonth'";	
            //echo $dateSQL;			
		}	
		
		return ($dateSQL);
	} 
	
	public function getStats($section=null, $subsection=null) {
		if (!$section) return 0;

		$sb = $subsection ? $subsection : 'value';
		return ($this->stats[$section][$sb]);
	}	
	
	public function isStats() {
		return (!empty($this->stats) ? true : false);
	}	
  
    protected function site_stats() {
		$db = GetGlobal('db'); 	
		$path = $this->application_path;
        $year = GetParam('year') ? GetParam('year') : date('Y'); 
	    $month = GetParam('month') ? GetParam('month') : date('m');	

		//$this->create_templates_XML();//null, true); return;
			
		$fs = $this->free_space();
		//if $total_size<0 ...goto upgrade.....		
		if ($fs < 0)
			$this->setTask('danger|'.localize('_upgradeplan', getlocal()).'|99');
		
        if ($id = _m("cmsrt.getRealItemCode use " . $this->cpGet['id'])) {
			//return (0); //test bypass
			$timeins = $this->sqlDateRange('date', true, true);	
			
			//stats
			$sSQL = "select count(id) from stats where tid='$id' " . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['value'] = $this->nformat($res->fields[0]);		

			$sSQL = "select distinct count(attr2) from stats where tid='$id' " . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['unique'] = $this->nformat($res->fields[0]);				
			
			$sSQL = "select count(id) from stats where tid='$id' and attr1='cartin'" . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['cartin'] = $this->nformat($res->fields[0]);	

			$sSQL = "select count(id) from stats where tid='$id' and attr1='cartout'" . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['cartout'] = $this->nformat($res->fields[0]);
	
	        //wishlists
			$sSQL = "select count(recid) from wishlist where tid='$id' and listname='wishlist'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['wishlist'] = $this->nformat($res->fields[0]);

			$sSQL = "select count(recid) from wishlist where tid='$id' and listname='compares'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['compares'] = $this->nformat($res->fields[0]);		

			$sSQL = "select count(recid) from wishlist where tid='$id' and listname='favorites'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['favorites'] = $this->nformat($res->fields[0]);	

			$sSQL = "select count(recid) from wishlist where tid='$id'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['wishall'] = $this->nformat($res->fields[0]);
			
			//ypoloipo
			$sSQL = "select ypoloipo1 from products where ". _v('cmsrt.fcode') ."='$id'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Item']['ypoloipo1'] = $this->nformat($res->fields[0]);
			
			//return (0); //test bypass
			
			//transactions
			$timeins = $this->sqlDateRange('tdate', false, true);
			
			$sSQL = "select count(recid) from transactions where tstatus>=0 and tdata like '%$id%'" . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Purchase']['transactions'] = $this->nformat($res->fields[0]);

			$sSQL = "select tdata from transactions where tstatus>=0 and tdata like '%$id%'" . $timeins;
			$result = $db->Execute($sSQL,2);
			//echo $sSQL;	   
			$counter = 0;
			$qty = 0;
			$value = 0;
			foreach ($result as $n=>$rec) {	
				$tdata = $rec['tdata'];
				if ($tdata) {
					$cdata = unserialize($tdata);
					foreach ($cdata as $i=>$buffer_data) {
						$param = explode(";",$buffer_data);
						if ($param[0]==$id) {
							$counter += 1;
							$qty += $param[9];
							$value += $param[9] * floatval(str_replace(',','.',$param[8]));
							//echo "<br/>" . $param[9]. ' * '.$param[8];
						}  	
					}	 
				} 
			} 
			$this->stats['Purchase']['orders'] = $this->nformat($counter);	
			$this->stats['Purchase']['qty'] = $this->nformat($qty);
			$this->stats['Purchase']['value'] = $this->nformat($value, 2);

		}
		elseif ($cat = $this->cpGet['cat']) {
			//return (0); //test bypass
			$timeins = $this->sqlDateRange('date', true, true);	
			
			//stats (category)
			$sSQL = "select count(id) from stats where attr1='$cat' " . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['value'] = $this->nformat($res->fields[0]);			
			
			$sSQL = "select distinct count(attr2) from stats where attr1='$cat' " . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Visits']['unique'] = $this->nformat($res->fields[0]);	


			/**** find category's items ***/
			$activecode = _v('cmsrt.fcode');
			$csep = _m('cmsrt.sep');
			$mcat = explode($csep, $cat);
			foreach ($mcat as $c=>$category)
				$catSQL .= " AND cat$c = " . $db->qstr(_m("cmsrt.replace_spchars use $category+1"));
			
			//items
			$sSQL = "select $activecode from products where active>0 AND itmactive>0 " . $catSQL;
			$result = $db->Execute($sSQL,2);
			foreach ($result as $i=>$rec) $items[] = $rec[0];
			$this->stats['Items']['active'] = count($items);
			
			$sSQL = "select count($activecode) from products where (active=0 OR itmactive=0) " . $catSQL;
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['inactive'] = $this->nformat($res->fields[0]);				

	        //stats (items)
			$sSQL = "select count(id) from stats where tid in ('" . implode("','", $items) . "') " . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['visits'] = $this->nformat($res->fields[0]);				
			
			//wishlists
			$sSQL = "select count(recid) from wishlist where tid in ('" . implode("','", $items) . "') ";
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['wishall'] = $this->nformat($res->fields[0]);
			
			//return (0); //test bypass
			
			//transactions
			$timeins = $this->sqlDateRange('tdate', false, true);
			
			$sSQL = "select count(recid) from transactions where tstatus>=0 and tdata REGEXP '". implode('|', $items) ."'" . $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['transactions'] = $this->nformat($res->fields[0]);

			$sSQL = "select tdata from transactions where tstatus>=0 and tdata REGEXP '". implode('|', $items) ."'" . $timeins;
			$result = $db->Execute($sSQL,2);
			//echo $sSQL;	   
			$counter = 0;
			$qty = 0;
			$value = 0;
			foreach ($result as $n=>$rec) {	
				$tdata = $rec['tdata'];
				if ($tdata) {
					$cdata = unserialize($tdata);
					foreach ($cdata as $i=>$buffer_data) {
						$param = explode(";",$buffer_data);
						if (in_array($param[0], $items)) {
							$counter += 1;
							$qty += $param[9];
							$value += $param[9] * floatval(str_replace(',','.',$param[8]));
							//echo "<br/>" . $param[9]. ' * '.$param[8];
						}  	
					}	 
				} 
			} 
			$this->stats['Items']['orders'] = $this->nformat($counter);	
			$this->stats['Items']['qty'] = $this->nformat($qty);
			$this->stats['Items']['income'] = $this->nformat($value, 2);			
		}		
		else {
			//users items lists etc
            $sSQL = "select count(id) from users";
			$res = $db->Execute($sSQL,2);
            $this->stats['Users']['value'] = $this->nformat($res->fields[0]);			
			
            $sSQL = "select count(id) from users where subscribe=1"; /** default label in ulist **/
			$res = $db->Execute($sSQL,2);	
            $this->stats['Users']['Subscribers'] = $this->nformat($res->fields[0]);
			
            $sSQL = "select count(id) from customers";
			$res = $db->Execute($sSQL,2);	
            $this->stats['Users']['customers'] = $this->nformat($res->fields[0]);			
			
            $sSQL = "select count(id) from ulists";
			$res = $db->Execute($sSQL,2);	
            $this->stats['Mail']['maillist'] = $this->nformat($res->fields[0]);			

            $sSQL = "select count(id) from pphotos where stype='SMALL'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['DbPicSmall'] = $this->nformat($res->fields[0]);			
			
            $sSQL = "select count(id) from pphotos where stype='MEDIUM'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['DbPicMedium'] = $this->nformat($res->fields[0]);			
			
            $sSQL = "select count(id) from pphotos where stype='LARGE'";
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['DbPicLarge'] = $this->nformat($res->fields[0]);
			
            $sSQL = "select count(id) from pattachments";
			$res = $db->Execute($sSQL,2);	
            $this->stats['Items']['Attachments'] = $this->nformat($res->fields[0]);			
			
            //products
            $timeins = $this->sqlDateRange('sysins', false, false);	
			$where = $timeins ? ' where ' : null;
		    //$sSQL = "select id,substr(sysins,1,4) as year,substr(sysins,6,2) as month from products where substr(sysins,1,4)='$year' and substr(sysins,6,2)='$month'";
			$sSQL = "select count(id) from products where" . $where .  $timeins;
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['insert'] = $this->nformat($res->fields[0]);			
					
			$timeupd = $this->sqlDateRange('sysupd', false, false);			 
			$where = $timeupd ? ' where ' : null;
		    //$sSQL = "select id,substr(sysupd,1,4) as year,substr(sysupd,6,2) as month from products where substr(sysupd,1,4)='$year' and substr(sysupd,6,2)='$month'";
			$sSQL = "select count(id) from products" . $where . $timeupd;
			$res = $db->Execute($sSQL,2);
            $this->stats['Items']['update'] = $this->nformat($res->fields[0]);			
								
            $sSQL = "select count(id) from products where itmactive=1 and active=101";
			$res = $db->Execute($sSQL,2);	
            $this->stats['Items']['active'] = $this->nformat($res->fields[0]);			
						
            $sSQL = "select count(id) from products where (itmactive=0 and active=0) or (itmactive is null and active is null)";//or...
			$res = $db->Execute($sSQL,2);	
            $this->stats['Items']['inactive'] = $this->nformat($res->fields[0]);			
						
            $sSQL = "select count(id) from products";
			$res = $db->Execute($sSQL,2);	
            $this->stats['Items']['value'] = $this->nformat($res->fields[0]);


			//transactions
			$timein = $this->sqlDateRange('tdate', false, true);
			$sSQL = "select count(recid) from transactions where tstatus>=0 " . $timein;
			//echo $sSQL;
			$res = $db->Execute($sSQL,2);
			$this->stats['Transactions']['value'] = $res->fields[0] ? $this->nformat($res->fields[0]) : 0;			
			
		    $sSQL = "select sum(cost),sum(costpt) from transactions where tstatus>=0 " . $timein;
			//echo $sSQL;	
			$res = $db->Execute($sSQL,2);
			$this->stats['Transactions']['revenuenet'] = $this->nformat($res->fields[0],2);
			$this->stats['Transactions']['revenue'] = $this->nformat($res->fields[1],2);			
			$this->stats['Transactions']['tax'] = $this->nformat((floatval($res->fields[1]) - floatval($res->fields[0])),2);			
			
			//mail, campaigns
			$timein = $this->sqlDateRange('timein', true, true);			
		    $sSQL = "select count(id) from mailqueue where active=0 " . $timein;
			$res = $db->Execute($sSQL,2);
            //$this->stats['Mail']['sent'] = $this->nformat($res->fields[0]);		
			$this->stats['Mail']['value'] = $this->nformat($res->fields[0]);		
			
			$sSQL = "select count(id) from mailqueue where active=1 " . $timein;
			$res = $db->Execute($sSQL,2);
            $this->stats['Mail']['send'] = $this->nformat($res->fields[0]);				

		    $sSQL = "select count(id) from mailcamp where active=1 " . $timein;
			$res = $db->Execute($sSQL,2);
            $this->stats['Mail']['campaigns'] = $this->nformat($res->fields[0]);			
			
			return (0); //test bypass			

			//synsql
			$timein = $this->sqlDateRange('time', true, true);//false);			 
			//$where = $timein ? ' where ' : null;
			//$sSQL = "select count(id), sum(CHAR_LENGTH(sqlquery)) from syncsql" . $where . $timein;
			$sSQL = "select count(id), sum(CHAR_LENGTH(sqlquery)) from syncsql where reference NOT LIKE 'system' and reference NOT LIKE 'cron' " . $timein;
			$res = $db->Execute($sSQL,2);
			
            $this->stats['Sync']['value'] = $this->nformat($res->fields[0]);		
			$this->stats['Sync']['bytes'] = $this->bytesToSize1024($res->fields[1],1); //$chars_send,1);
			
			$timein = $this->sqlDateRange('time', true, true);			 
			$sSQL = "select count(id) from syncsql where status <> 1 " . $timein;
			$res = $db->Execute($sSQL,2);			
			$this->stats['Sync']['noexec'] = $this->nformat($res->fields[0]); 			
			
			//mail campaigns
			$timein = $this->sqlDateRange('timein', true, false);
            $where = $timein ? ' where ' : null;			
			$sSQL = "select count(id), sum(CHAR_LENGTH(body)) from mailqueue" . $where . $timein;
			//echo $sSQL;
			$res = $db->Execute($sSQL,2);
			
			$this->stats['Mail']['value'] = $this->nformat($res->fields[0]); 
			$this->stats['Mail']['bytes'] = $this->bytesToSize1024($res->fields[1],1); //$chars_send,1);		

		    $sSQL = "select count(id) from mailqueue " . $where . $timein;;
			$res = $db->Execute($sSQL,2);
            $this->stats['Mail']['value'] = $this->nformat($res->fields[0]);			

		}  

        return (1);     	
    }
	
	public function nformat($n, $dec=0) {
		return (number_format($n,$dec,',','.'));
	}
	
    public function bytesToSize1024($bytes, $precision = 2) {
        $unit = array('B','KB','MB','GB');
        return @round($bytes / pow(1024, ($i = floor(log($bytes, 1024)))), $precision).' '.$unit[$i];
    }  
 
 
    protected function filesize_r($path){
				
		if (!file_exists($path)) 
			return 0;
		
	    if (is_file($path)) 
			return filesize($path);
			
		$ret = 0;
		
		$glob = glob($path."/*", GLOB_NOSORT);
		
		if (is_array($glob)) {
			foreach(glob($path."/*", GLOB_NOSORT) as $fn)
				$ret += $this->filesize_r($fn);
		}	
		return $ret;

    } 
	
    protected function cached_mail_size($cahcetime=null) {
	   $path = '/home/'.$this->rootapp_path.'/mail/' . str_replace('www.','',$this->url);
       $name = 'a';//strval(date('Ymd'));
       $msize = $this->prpath . $name . '-msize.size';
	   $size = 0;
	   
	   $filemtime = @filemtime($msize);
	   $cache_life = $cahcetime ? $cahcetime : 86400; //1 day
	   
       if ((is_readable($msize)) && (time() - $filemtime <= $cache_life)) {
	        //echo $msize;
			$size = @file_get_contents($msize);

	   }
	   else { 
            $size = $this->filesize_r($path);
			@file_put_contents($msize, $size);
	   }
	   
	   return ($size);
    }	
  	
	
    protected function cached_disk_size($cahcetime=null) {
  	   $path = $this->application_path; 
       $name = 'a';//strval(date('Ymd'));
       $tsize = $this->prpath . $name . '-tsize.size';
	   $size = 0;
	   
	   $filemtime = @filemtime($tsize);
	   $cache_life = $cahcetime ? $cahcetime : 86400; //1 day
	   
       if ((is_readable($tsize)) && (time() - $filemtime <= $cache_life)) {	   
	        //echo $tsize;
			$size = @file_get_contents($tsize);

	   }
	   else {
            $size = $this->filesize_r($path);
			@file_put_contents($tsize, $size);
	   }
	   
	   return ($size);
    }	
	
    protected function cached_database_filesize($cahcetime=null) {
      $db = GetGlobal('db'); 
      $name = 'a'; //strval(date('Ymd'));
      $dsize = $this->prpath . $name . '-dsize.size';	
	
	  $filemtime = @filemtime($dsize);
	  $cache_life = $cahcetime ? $cahcetime : 86400; //1 day
	   
      if ((is_readable($dsize)) && (time() - $filemtime <= $cache_life)) {
	    //echo $dsize;
		$size = @file_get_contents($dsize);

	  }
	  else {
		$sSQL = "SHOW TABLE STATUS";
		$res = $db->Execute($sSQL,2);		

		$size = 0;
		if (!empty($res)) { 
			foreach ($res as $n=>$rec) {
				$size += $rec[ "Data_length" ] + $rec[ "Index_length" ];					
			}
		}
		@file_put_contents($dsize, $size);
	  }	
		
	  return ($size);
    }	
	
	//get the free space
	public function free_space() {
        $year = GetParam('year') ? GetParam('year') : date('Y'); 
	    $month = GetParam('month') ? GetParam('month') : date('m');			
		
		set_time_limit(120); 
		
		$msize = $this->cached_mail_size();
		$msize2 = $this->bytesToSize1024($msize,1);

		$this->stats['Diskspace']['mailbox'] = $msize2;	
				
		$tsize = $this->cached_disk_size();
		$tsize2 = $this->bytesToSize1024($tsize,1);
		
		$this->stats['Diskspace']['hd'] = $tsize2;
			
        $dsize = $this->cached_database_filesize();	
		$dsize2 = $this->bytesToSize1024($dsize,1);	

		$this->stats['Diskspace']['db'] = $dsize2;
			
		$total_size = $tsize + $dsize + $msize;
		$stotal = $this->bytesToSize1024($total_size,1);

		$this->stats['Diskspace']['value'] = $stotal;
		
		set_time_limit(ini_get('max_execution_time'));
			
		//alowed size
		$rtotal = intval(@file_get_contents($this->prpath .'maxsize.conf.php')); //????????????????????????
		//echo 'Size allowed:',$rtotal;
		$allowed_size = $this->bytesToSize1024($rtotal,1);
		
		$this->stats['Diskspace']['size'] = $allowed_size;
			
		//remain size
		$remain_size = intval($rtotal - $total_size);
		$rmtotal = $this->bytesToSize1024($remain_size,1);

		$this->stats['Diskspace']['remain'] = $rmtotal;		
		//echo 'Size remain:',$remain_size;
		
		//% remaining total size / space allowed
		$this->stats['Diskspace']['remainsizepercent'] = round($total_size*100/$rtotal);
		//% db size / space used
		$this->stats['Diskspace']['remaindbpercent'] = round($dsize*100/$total_size);
		//% mailbox size / used
		$this->stats['Diskspace']['remainmxpercent'] = round($msize*100/$total_size);
		//% hd size /space used
		$this->stats['Diskspace']['remainhdpercent'] = round($tsize*100/$total_size);	

		/*size % used check */
		if ($this->stats['Diskspace']['remainsizepercent'] > 90) 
			$this->setTask('danger|'. localize('_sizeconsumed', getlocal()) .'|'.$this->stats['Diskspace']['remainsizepercent'].'|#');	
		elseif ($this->stats['Diskspace']['remainsizepercent'] > 80) 
			$this->setTask('warning|'. localize('_sizeconsumed', getlocal()) .'|'.$this->stats['Diskspace']['remainsizepercent'].'|#');	
		elseif ($this->stats['Diskspace']['remainsizepercent'] > 70) 
			$this->setTask('info|'. localize('_sizeconsumed', getlocal()) .'|'.$this->stats['Diskspace']['remainsizepercent'].'|#');			

		return ($remain_size);	
	}
	
	protected function cpinfo($s=null) {

		switch ($s) {
			case 'users'        : $ret = "<h2>Users</h2>"; 
								  $ret .= '<p>Total users:'.$this->getStats('Users');  
								  $ret .= '</p>';	
			                      break;
			case 'customers'    : $ret = "<h2>Customers</h2>"; 
								  $ret .= '<p>Total customers:'.$this->getStats('Users','customers');  
								  $ret .= '</p>';
			                      break;
			case 'ulists'       : $ret = "<h2>Mailing Lists</h2>";
								  $ret .= '<p>Total subscribers:'.$this->getStats('Mail','maillist');  
								  $ret .= '</p>';		
			                      break;
			case 'mails'        : $ret = "<h2>Mails</h2>"; 
								  $ret .= '<p><br>Total mails:'.$this->getStats('Mail');  
								  $ret .= '<br>Mails to send:'.$this->getStats('Mail','send'); 
			                      $ret .= '<br>Mails sent:'.$this->getStats('Mail','sent');
								  $ret .= '<br>Data sent:'.$this->getStats('Mail','bytes') .'</p>';
			                      break;
			case 'camps'        : $ret = "<h2>Campaigns</h2>";
								  $ret .= '<p>Total campaigns:'.$this->getStats('Mail','campaigns');  
								  $ret .= '</p>';			
			                      break;
			case 'items'        : $ret = "<h2>Items</h2>";
			                      $ret .= '<p>Total items:'.$this->getStats('Items');  
								  $ret .= '<br>Active items:'.$this->getStats('Items','active'); 
			                      $ret .= '<br>Inactive items:'.$this->getStats('Items','inactive'); 
								  $ret .= '<br>Inactive items:'.$this->getStats('Items','insert');
								  $ret .= '<br>Inactive items:'.$this->getStats('Items','update') . '<hr/>';
								  $ret .= 'Syncs:'.$this->getStats('Sync');  
								  $ret .= '<br>Errors:'.$this->getStats('Sync','noexec'); 
			                      $ret .= '<br>Traffic:'.$this->getStats('Sync','bytes') .'</p>';
			                      break;
			case 'transactions' : $ret = "<h2>Transactions</h2>";
			                      $ret .= '<p>Transactions:'.$this->getStats('Transactions');  
								  $ret .= '<br>Revenue (net):'.$this->getStats('Transactions', 'revenuenet'); 
			                      $ret .= '<br>Revenue:'.$this->getStats('Transactions','revenue');
								  $ret .= '<br>Tax:'.$this->getStats('Transactions','tax') .'</p>';  
			                      break;
			default             : $ret = "<h2>Info</h2>";
								  $ret .= '<p>Disk space used:'.$this->getStats('Diskspace');  
								  $ret .= '<br>HD size:'.$this->getStats('Diskspace','hd'); 
								  $ret .= '<br>DB size:'.$this->getStats('Diskspace','db'); 
								  $ret .= '<br>MX size:'.$this->getStats('Diskspace','mailbox') . '<hr>'; 
			                      $ret .= 'Max space:'.$this->getStats('Diskspace','size') ;
								  $ret .= '<br>Free space:'.$this->getStats('Diskspace','remain') .'</p>';	
		}
		
		return ("cpinfo|".$ret);
	}
	
	protected function set_space($space_in_mb) {
	    $spacefile = $this->prpath . '/maxsize.conf.php';
	    
	    $space = intval($space_in_mb * 1024 * 1024);
		$ok = @file_put_contents($spacefile ,$space);
		
		return ($ok);
	}
	
	//set task method
	public function setTask($task=null) {
		if (!$task) return false;
		$id = explode('|',$task);
		$hash = md5($id[0].$id[1]);
		
		//if (array_key_exists($hash, $this->tasks)) {}
		//else {
			$this->tasks[$hash] = $task;
			SetSessionParam('cpTasks', $this->tasks);
			return true;
		//}
		//return false;	
	}
	
	public function viewTasks($template=null) {
		if (empty($this->tasks)) return;
	    $t = ($template!=null) ? _m("cmsrt.select_template use $template+1") : null;
		//$msgs = array_reverse($this->tasks, true);

		foreach ($this->tasks as $t=>$task) {
			$tokens = explode('|', $task); 
			//$tsk = $tokens[1];
			if ($t) 	
				$ret .= $this->combine_tokens($t, array_shift($tokens)); //array(0=>$tsk));
			else
				$ret .= "<option value=\"$t\">$tsk</option>";
		}
		return ($ret);
	}	
	
	//set inbox method
	public function setInbox($message=null) {
		$db = GetGlobal('db');
		if (!$message) return false;
		
		$interval = $daysback ? $daysback : 90;
		$id = explode('|',$message);
		$hash = md5($id[0].$id[1]);
		
		//add the message if not already in session		
		if (array_key_exists($hash, $this->inbox)) { /* in session */}
		else {
			$this->inbox[$hash] = $message;
			SetSessionParam('cpInbox', $this->inbox);
			return true;
		}
		return false;	
	}	
	
    //zip directory
    protected function zip_directory($path=null, $name=null) {
        $d = date('Ymd-Hi');
		$zpath = $path ? $path : '';
        $zname = $name ? $d.'-'.$name : $d.'-'.'backup.zip'; 
		$dirname = $this->prpath . '/' . $zpath;
  
        //echo $dirname;
	    if (is_dir($dirname)) {
			$mydir = dir($dirname);
		  
			$zip = new ZipArchive();
			$zfilename = $this->prpath . "/uploads/" . $zname; //to save into

			if ($zip->open($zfilename, ZipArchive::CREATE)!==TRUE) 
				return false;	  
		 
			while ($fileread = $mydir->read ()) {
	        
				if (($fileread!='.') && ($fileread!='..'))  {
					if (!is_dir($fileread))   
						$zip->addFile($dirname."/".$fileread, $fileread);						
				} 
			}
			$mydir->close ();
		  
			$ret = "numfiles: " . $zip->numFiles . "\n";
			$ret .= "status:" . $zip->status . "\n";
			$zip->close();		  
        }

		return ($ret);
    }    	

	//put partial files into one xml file
	protected function create_templates_XML($template=false, $iscp=false) {
		$tpath = $iscp ? _v('cmsrt.cptemplate') : ($template ? $template : _v('cmsrt.template'));
		$ppath = $this->prpath . _v('cmsrt.tpath') .'/'. $tpath . '/' ; 
		
		$xml = new pxml();
		$xml->encoding = 'utf-8';
		$xml->addtag('e-Enterprise',null,null,"url={$this->httpurl}|name=$xml->urltitle|encoding=utf-8");							
		$xml->addtag('template','e-Enterprise',$ppath,null);						
		
		foreach (glob($ppath . "*.php") as $filename) {
			
			$ftitle = str_replace(array(".php", $ppath), array('',''), $filename);
			$fdata = trim(@file_get_contents($filename));
			
			$xml->addtag('part','template',null,null);				      
			$xml->addtag('name','part',$ftitle,null);				   
			$xml->addtag('body','part',$xml->cdata($fdata),null);				   			   				   			   
										
		}
		//$xml->dumpxml();
		$ret = @file_put_contents($ppath . '/template-parts.xml', $xml->getxml(1));
		
		return ($ret);	
	}	
  
	public function get_user_name($nopro=0) {
		if ((GetSessionParam('LOGIN')) && ($user=GetSessionParam('USER')))
			return ($user);	
	  
		return false;	  
	}

    protected function autoupdate() {
		
	}
  
    public function getencoding() {
		return ($this->charset);
    }
  
    protected function logout() {
  
		SetSessionParam('LOGIN',null);
		SetSessionParam('USER',null);
		SetSessionParam('env',null);
		//SetSessionParam('ADMIN',null); 
		
		SetSessionParam('turl', null);		
		SetSessionParam('turldecoded', null);
		SetSessionParam('cpGet', null);		
    }	

	public function getItemName($id) {
		if (!$id) return null;
		$db = GetGlobal('db');
		$lan = getlocal();
		$name = _v('cmsrt.itmname');
		$codef = _v('cmsrt.fcode');
		
		$sSQL = "select $name from products where $codef=" . $db->qstr($id);
		$res = $db->Execute($sSQL,2);

        return $res->fields[0];		
	}
	
	public function getItemActiveCode($id) {
		if (!$id) return null;
		$db = GetGlobal('db');
		$lan = getlocal();
		$code = _v('cmsrt.fcode');
		
		$sSQL = "select $code from products where id=" . $id;
		$res = $db->Execute($sSQL,2);
        return $res->fields[0];		
	}	
	
	public function getRefName($id) {
		if (!$id) return null;
		$db = GetGlobal('db');
		
		$sSQL = "select title from mailcamp where cid=" . $db->qstr($id);
		$res = $db->Execute($sSQL,2);
        return $res->fields[0];		
	}	
	
    public function checkmail($data) {
		return (filter_var($data, FILTER_VALIDATE_EMAIL) ? true : false);
	}

	public function timeSayWhen($ptime=null) {
		$etime = time() - $ptime;

		if ($etime < 1)
			return '1 ' . localize('second', getlocal());

		$a = array( 365 * 24 * 60 * 60  =>  'year',
					 30 * 24 * 60 * 60  =>  'month',
						  24 * 60 * 60  =>  'day',
							   60 * 60  =>  'hour',
                                    60  =>  'minute',
                                     1  =>  'second'
                  );
		$a_plural = array( 'year'   => 'years',
                           'month'  => 'months',
                           'day'    => 'days',
                           'hour'   => 'hours',
                           'minute' => 'minutes',
                           'second' => 'seconds'
                        );

		foreach ($a as $secs => $str) {
			$d = $etime / $secs;
			if ($d >= 1) {
				$r = round($d);
				$a = localize($a_plural[$str], getlocal());
				$b = localize($str, getlocal());
				return $r . ' ' . ($r > 1 ? $a : $b);// . ' ago';
			}
		}
	}	
	
	//called by page as json array...(NOT USED)
	public function jsTour($elements=null, $pos=null) {
		
		$el = explode(',',$elements);
		$ps = explode(',',$pos);
		
		foreach ($el as $i=>$e) {
			$tt[] = array('element'=>$e,
			              'tooltip'=>localize('_tooltip-'.$e,getlocal()),
						  'position'=>$ps[$i],
						  'text'=>localize('_text-'.$e,getlocal()),
						  );
		}
		//print_r($tt);
		//echo json_encode($tt);
		
		$ret = "[
		      { element : '.metro-nav', 'tooltip' : 'Metro style buttons', 'position' : 'T', 'text' : '<h3>Metro</h3><p>View all critial data in one view summarized by category. Every button is clickable and shows details about its data category</p>'  },
              { element : '.metro-nav-block.nav-light-blue', 'tooltip' : 'Star reading this first', 'position' : 'TL', 'text' : '<h3>jSON structure</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae mattis mi, quis imperdiet arcu. Nulla egestas mauris id velit ullamcorper aliquam. Proin faucibus volutpat justo, non faucibus massa dapibus ut. Sed mauris neque, aliquam vitae convallis eget, feugiat quis tortor. Suspendisse eleifend, nisl quis consequat tincidunt, erat nisi fringilla nisl, adipiscing venenatis arcu nibh in magna. Mauris sit amet lectus adipiscing, mattis augue a, adipiscing felis. Fusce tellus orci, venenatis in libero ac, molestie aliquam tortor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>' },
              { element : '.widget.purple', 'tooltip' : 'This can be used inside the body or head', 'position' : 'TR', 'text' : '<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae mattis mi, quis imperdiet arcu. Nulla egestas mauris id velit ullamcorper aliquam. Proin faucibus volutpat justo, non faucibus massa dapibus ut. Sed mauris neque, aliquam vitae convallis eget, feugiat quis tortor. Suspendisse eleifend, nisl quis consequat tincidunt, erat nisi fringilla nisl, adipiscing venenatis arcu nibh in magna. Mauris sit amet lectus adipiscing, mattis augue a, adipiscing felis. Fusce tellus orci, venenatis in libero ac, molestie aliquam tortor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>' },
              { element : '.controls', 'tooltip' : 'Or can be used into a click event', 'position' : 'BL' },
              { element : '.easy-pie-chart', 'tooltip' : 'The data section it is very important', 'position' : 'B', 'text' : '<h3>Data</h3><p>It is a attribute that contains every the texts and configurations that the plugin use</p>' },
              { element : '.update-btn', 'tooltip' : 'Use a selector!', 'position' : 'L', 'controlsPosition' : 'BR' },
              { element : '.icon-download', 'tooltip' : 'Like this', 'position' : 'T' },
              { element : '.widget.orange', 'tooltip' : 'This can be HTML! (be standard, pls)', 'position' : 'R' },
              { element : '#reservation', 'tooltip' : 'Oops! I just forgot myself configuration!', 'position' : 'R' },
              { element : '.divider-vertical', 'tooltip' : 'Backgrounds and more!', 'position' : 'B', 'text' : '<p>Use rgba() because it looks really nice</p>' },
              { element : '.nav.top-menu', 'tooltip' : 'Very soon...', 'position' : 'B', 'text' : '<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae mattis mi, quis imperdiet arcu. Nulla egestas mauris id velit ullamcorper aliquam. Proin faucibus volutpat justo, non faucibus massa dapibus ut. Sed mauris neque, aliquam vitae convallis eget, feugiat quis tortor. Suspendisse eleifend, nisl quis consequat tincidunt, erat nisi fringilla nisl, adipiscing venenatis arcu nibh in magna. Mauris sit amet lectus adipiscing, mattis augue a, adipiscing felis. Fusce tellus orci, venenatis in libero ac, molestie aliquam tortor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>' },
              { element : '.sidebar-menu', 'tooltip' : 'Please use it', 'position' : 'R' },
              { element : '.dropdown-toggle.element', 'tooltip' : 'fork it', 'position' : 'B', 'text' : '<h1>That\'s all!</h1><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae mattis mi, quis imperdiet arcu. Nulla egestas mauris id velit ullamcorper aliquam. Proin faucibus volutpat justo, non faucibus massa dapibus ut. Sed mauris neque, aliquam vitae convallis eget, feugiat quis tortor. Suspendisse eleifend, nisl quis consequat tincidunt, erat nisi fringilla nisl, adipiscing venenatis arcu nibh in magna. Mauris sit amet lectus adipiscing, mattis augue a, adipiscing felis. Fusce tellus orci, venenatis in libero ac, molestie aliquam tortor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>' }	
			 ] 
		";
		return ($ret);
	}	
  
	protected function combine_tokens($template, $tokens, $execafter=null) {
	    if (!is_array($tokens)) return;		

		if ((!$execafter) && (defined('FRONTHTMLPAGE_DPC'))) {
			$fp = new fronthtmlpage(null);
			$ret = $fp->process_commands($template);
			unset ($fp);		  		
		}		  		
		else
			$ret = $template;
		  
	    foreach ($tokens as $i=>$tok) 
		    $ret = str_replace("$".$i."$",$tok,$ret);

		for ($x=$i;$x<30;$x++)
			$ret = str_replace("$".$x."$",'',$ret);

		if (($execafter) && (defined('FRONTHTMLPAGE_DPC'))) {
			$fp = new fronthtmlpage(null);
			$retout = $fp->process_commands($ret);
			unset ($fp);
          
			return ($retout);
		}		
		
		return ($ret);
	} 		
	
};
}
?>